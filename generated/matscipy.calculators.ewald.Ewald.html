<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>matscipy.calculators.ewald.Ewald &mdash; matscipy devel documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="matscipy.calculators.manybody.Manybody" href="matscipy.calculators.manybody.Manybody.html" />
    <link rel="prev" title="matscipy.calculators.eam.EAM" href="matscipy.calculators.eam.EAM.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            matscipy
          </a>
              <div class="version">
                devel
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Matscipy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications/index.html">Application domains</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Analysis tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../calculators/index.html">Interatomic potentials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api.html#application-domains">Application domains</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#structure-and-topology-generation">Structure and topology generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#analysis-tools">Analysis tools</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api.html#interatomic-potentials">Interatomic potentials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="matscipy.calculators.calculator.html">matscipy.calculators.calculator</a></li>
<li class="toctree-l3"><a class="reference internal" href="matscipy.calculators.pair_potential.PairPotential.html">matscipy.calculators.pair_potential.PairPotential</a></li>
<li class="toctree-l3"><a class="reference internal" href="matscipy.calculators.polydisperse.Polydisperse.html">matscipy.calculators.polydisperse.Polydisperse</a></li>
<li class="toctree-l3"><a class="reference internal" href="matscipy.calculators.mcfm.MultiClusterForceMixingPotential.html">matscipy.calculators.mcfm.MultiClusterForceMixingPotential</a></li>
<li class="toctree-l3"><a class="reference internal" href="matscipy.calculators.eam.EAM.html">matscipy.calculators.eam.EAM</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">matscipy.calculators.ewald.Ewald</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#matscipy.calculators.ewald.Ewald"><code class="docutils literal notranslate"><span class="pre">Ewald</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="matscipy.calculators.manybody.Manybody.html">matscipy.calculators.manybody.Manybody</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#utility-functions">Utility functions</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">matscipy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">API Reference</a></li>
      <li class="breadcrumb-item active">matscipy.calculators.ewald.Ewald</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/generated/matscipy.calculators.ewald.Ewald.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="matscipy-calculators-ewald-ewald">
<h1>matscipy.calculators.ewald.Ewald<a class="headerlink" href="#matscipy-calculators-ewald-ewald" title="Permalink to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">matscipy.calculators.ewald.</span></span><span class="sig-name descname"><span class="pre">Ewald</span></span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="matscipy.calculators.pair_potential.PairPotential.html#matscipy.calculators.pair_potential.PairPotential" title="matscipy.calculators.pair_potential.calculator.PairPotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">PairPotential</span></code></a></p>
<p>Ewal summation calculator.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.alpha" title="matscipy.calculators.ewald.Ewald.alpha"><code class="xref py py-obj docutils literal notranslate"><span class="pre">alpha</span></code></a></dt><dd><p>Get alpha.</p>
</dd>
<dt><strong>directory</strong></dt><dd></dd>
<dt><strong>label</strong></dt><dd></dd>
<dt><strong>short_range</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.allowed_wave_vectors" title="matscipy.calculators.ewald.Ewald.allowed_wave_vectors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">allowed_wave_vectors</span></code></a>(cell, km, a, nk)</p></td>
<td><p>Compute allowed wave vectors and the prefactor I</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.band_structure" title="matscipy.calculators.ewald.Ewald.band_structure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">band_structure</span></code></a>()</p></td>
<td><p>Create band-structure object for plotting.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.calculate" title="matscipy.calculators.ewald.Ewald.calculate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate</span></code></a>(atoms, properties, system_changes)</p></td>
<td><p>Compute Coulomb interactions with Ewald summation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.calculate_numerical_forces" title="matscipy.calculators.ewald.Ewald.calculate_numerical_forces"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_numerical_forces</span></code></a>(atoms[, d])</p></td>
<td><p>Calculate numerical forces using finite difference.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.calculate_numerical_stress" title="matscipy.calculators.ewald.Ewald.calculate_numerical_stress"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_numerical_stress</span></code></a>(atoms[, d, voigt])</p></td>
<td><p>Calculate numerical stress using finite difference.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.calculate_properties" title="matscipy.calculators.ewald.Ewald.calculate_properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_properties</span></code></a>(atoms, properties)</p></td>
<td><p>This method is experimental; currently for internal use.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.check_state" title="matscipy.calculators.ewald.Ewald.check_state"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_state</span></code></a>(atoms[, tol])</p></td>
<td><p>Check for any system changes since last calculation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.determine_alpha" title="matscipy.calculators.ewald.Ewald.determine_alpha"><code class="xref py py-obj docutils literal notranslate"><span class="pre">determine_alpha</span></code></a>(charge, acc, cutoff, cell)</p></td>
<td><p>Determine an estimate for alpha on the basis of the cell, cutoff and desired accuracy (Adopted from LAMMPS)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.determine_kc" title="matscipy.calculators.ewald.Ewald.determine_kc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">determine_kc</span></code></a>(cell, nk)</p></td>
<td><p>Determine maximal wave vector based in a given integer triplet</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.determine_nk" title="matscipy.calculators.ewald.Ewald.determine_nk"><code class="xref py py-obj docutils literal notranslate"><span class="pre">determine_nk</span></code></a>(charge, cell, acc, a, natoms)</p></td>
<td><p>Determine the maximal number of points in reciprocal space for each direction, and the cutoff in reciprocal space</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.first_derivative_kspace" title="matscipy.calculators.ewald.Ewald.first_derivative_kspace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">first_derivative_kspace</span></code></a>(charge, natoms, vol, ...)</p></td>
<td><p>Return the kspace part of the force.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_birch_coefficients" title="matscipy.calculators.ewald.Ewald.get_birch_coefficients"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_birch_coefficients</span></code></a>(atoms)</p></td>
<td><p>Compute the Birch coefficients (Effective elastic constants at non-zero stress).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_born_elastic_constants" title="matscipy.calculators.ewald.Ewald.get_born_elastic_constants"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_born_elastic_constants</span></code></a>(atoms)</p></td>
<td><p>Compute the Born elastic constants.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_dynamical_matrix" title="matscipy.calculators.ewald.Ewald.get_dynamical_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_dynamical_matrix</span></code></a>(atoms)</p></td>
<td><p>Compute dynamical matrix (=mass weighted Hessian).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_elastic_constants" title="matscipy.calculators.ewald.Ewald.get_elastic_constants"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_elastic_constants</span></code></a>(atoms[, cg_parameters])</p></td>
<td><p>Compute the elastic constants at zero temperature.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_hessian" title="matscipy.calculators.ewald.Ewald.get_hessian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_hessian</span></code></a>(atoms[, format])</p></td>
<td><p>Compute the real space + kspace Hessian</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_magnetic_moments" title="matscipy.calculators.ewald.Ewald.get_magnetic_moments"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_magnetic_moments</span></code></a>([atoms])</p></td>
<td><p>Calculate magnetic moments projected onto atoms.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_non_affine_contribution_to_elastic_constants" title="matscipy.calculators.ewald.Ewald.get_non_affine_contribution_to_elastic_constants"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_non_affine_contribution_to_elastic_constants</span></code></a>(atoms)</p></td>
<td><p><cite>get_non_affine_contribution_to_elastic_constants</cite> is deprecated, use <cite>elasticity.nonaffine_elastic_contribution</cite> instead!</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_nonaffine_forces" title="matscipy.calculators.ewald.Ewald.get_nonaffine_forces"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_nonaffine_forces</span></code></a>(atoms)</p></td>
<td><p>Compute the non-affine forces which result from an affine deformation of atoms.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_numerical_non_affine_forces" title="matscipy.calculators.ewald.Ewald.get_numerical_non_affine_forces"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_numerical_non_affine_forces</span></code></a>(atoms[, d])</p></td>
<td><p><cite>get_numerical_non_affine_forces</cite> is deprecated, use <cite>numerical.numerical_nonaffine_forces</cite> instead!</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_property" title="matscipy.calculators.ewald.Ewald.get_property"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_property</span></code></a>(name[, atoms, allow_calculation])</p></td>
<td><p>Get the named property.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_stress_contribution_to_elastic_constants" title="matscipy.calculators.ewald.Ewald.get_stress_contribution_to_elastic_constants"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_stress_contribution_to_elastic_constants</span></code></a>(atoms)</p></td>
<td><p>Compute the correction to the elastic constants due to non-zero stress in the configuration.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_stresses" title="matscipy.calculators.ewald.Ewald.get_stresses"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_stresses</span></code></a>([atoms])</p></td>
<td><p>the calculator should return intensive stresses, i.e., such that stresses.sum(axis=0) == stress</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.kspace_energy" title="matscipy.calculators.ewald.Ewald.kspace_energy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kspace_energy</span></code></a>(charge, pos, vol, I, k)</p></td>
<td><p>Return the energy from the reciprocal space contribution</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.kspace_properties" title="matscipy.calculators.ewald.Ewald.kspace_properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kspace_properties</span></code></a>(atoms[, prop, ...])</p></td>
<td><p>Calculate the recirprocal contributiom to the Hessian, the non-affine forces and the Born elastic constants</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.read" title="matscipy.calculators.ewald.Ewald.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read</span></code></a>(label)</p></td>
<td><p>Read atoms, parameters and calculated properties from output file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.reset" title="matscipy.calculators.ewald.Ewald.reset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset</span></code></a>()</p></td>
<td><p>Clear all information from old calculation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.reset_kspace" title="matscipy.calculators.ewald.Ewald.reset_kspace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_kspace</span></code></a>(atoms)</p></td>
<td><p>Reset kspace setup.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.rms_kspace" title="matscipy.calculators.ewald.Ewald.rms_kspace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rms_kspace</span></code></a>(km, l, n, a, q2)</p></td>
<td><p>Compute the root mean square error of the force in reciprocal space</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.rms_rspace" title="matscipy.calculators.ewald.Ewald.rms_rspace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rms_rspace</span></code></a>(charge, cell, a, rc)</p></td>
<td><p>Compute the root mean square error of the force in real space</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.self_energy" title="matscipy.calculators.ewald.Ewald.self_energy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">self_energy</span></code></a>(charge, a)</p></td>
<td><p>Return the self energy</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.set" title="matscipy.calculators.ewald.Ewald.set"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set</span></code></a>(**kwargs)</p></td>
<td><p>Set parameters like set(key1=value1, key2=value2, ...).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.set_label" title="matscipy.calculators.ewald.Ewald.set_label"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_label</span></code></a>(label)</p></td>
<td><p>Set label and convert label to directory and prefix.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.stress_kspace" title="matscipy.calculators.ewald.Ewald.stress_kspace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stress_kspace</span></code></a>(charge, pos, vol, a, I, k)</p></td>
<td><p>Return the stress contribution of the long-range Coulomb part.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>calculation_required</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>export_properties</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_atoms</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_charges</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_default_parameters</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_dipole_moment</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_forces</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_magnetic_moment</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_potential_energies</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_potential_energy</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_stress</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>read_atoms</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>todict</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Construct calculator.</p>
</dd></dl>

<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#id0" title="matscipy.calculators.ewald.Ewald.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>()</p></td>
<td><p>Construct calculator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.allowed_wave_vectors" title="matscipy.calculators.ewald.Ewald.allowed_wave_vectors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">allowed_wave_vectors</span></code></a>(cell, km, a, nk)</p></td>
<td><p>Compute allowed wave vectors and the prefactor I</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.band_structure" title="matscipy.calculators.ewald.Ewald.band_structure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">band_structure</span></code></a>()</p></td>
<td><p>Create band-structure object for plotting.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.calculate" title="matscipy.calculators.ewald.Ewald.calculate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate</span></code></a>(atoms, properties, system_changes)</p></td>
<td><p>Compute Coulomb interactions with Ewald summation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.calculate_numerical_forces" title="matscipy.calculators.ewald.Ewald.calculate_numerical_forces"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_numerical_forces</span></code></a>(atoms[, d])</p></td>
<td><p>Calculate numerical forces using finite difference.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.calculate_numerical_stress" title="matscipy.calculators.ewald.Ewald.calculate_numerical_stress"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_numerical_stress</span></code></a>(atoms[, d, voigt])</p></td>
<td><p>Calculate numerical stress using finite difference.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.calculate_properties" title="matscipy.calculators.ewald.Ewald.calculate_properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_properties</span></code></a>(atoms, properties)</p></td>
<td><p>This method is experimental; currently for internal use.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.calculation_required" title="matscipy.calculators.ewald.Ewald.calculation_required"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculation_required</span></code></a>(atoms, properties)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.check_state" title="matscipy.calculators.ewald.Ewald.check_state"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_state</span></code></a>(atoms[, tol])</p></td>
<td><p>Check for any system changes since last calculation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.determine_alpha" title="matscipy.calculators.ewald.Ewald.determine_alpha"><code class="xref py py-obj docutils literal notranslate"><span class="pre">determine_alpha</span></code></a>(charge, acc, cutoff, cell)</p></td>
<td><p>Determine an estimate for alpha on the basis of the cell, cutoff and desired accuracy (Adopted from LAMMPS)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.determine_kc" title="matscipy.calculators.ewald.Ewald.determine_kc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">determine_kc</span></code></a>(cell, nk)</p></td>
<td><p>Determine maximal wave vector based in a given integer triplet</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.determine_nk" title="matscipy.calculators.ewald.Ewald.determine_nk"><code class="xref py py-obj docutils literal notranslate"><span class="pre">determine_nk</span></code></a>(charge, cell, acc, a, natoms)</p></td>
<td><p>Determine the maximal number of points in reciprocal space for each direction, and the cutoff in reciprocal space</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.export_properties" title="matscipy.calculators.ewald.Ewald.export_properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">export_properties</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.first_derivative_kspace" title="matscipy.calculators.ewald.Ewald.first_derivative_kspace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">first_derivative_kspace</span></code></a>(charge, natoms, vol, ...)</p></td>
<td><p>Return the kspace part of the force.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_atoms" title="matscipy.calculators.ewald.Ewald.get_atoms"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_atoms</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_birch_coefficients" title="matscipy.calculators.ewald.Ewald.get_birch_coefficients"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_birch_coefficients</span></code></a>(atoms)</p></td>
<td><p>Compute the Birch coefficients (Effective elastic constants at non-zero stress).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_born_elastic_constants" title="matscipy.calculators.ewald.Ewald.get_born_elastic_constants"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_born_elastic_constants</span></code></a>(atoms)</p></td>
<td><p>Compute the Born elastic constants.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_charges" title="matscipy.calculators.ewald.Ewald.get_charges"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_charges</span></code></a>([atoms])</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_default_parameters" title="matscipy.calculators.ewald.Ewald.get_default_parameters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_default_parameters</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_dipole_moment" title="matscipy.calculators.ewald.Ewald.get_dipole_moment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_dipole_moment</span></code></a>([atoms])</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_dynamical_matrix" title="matscipy.calculators.ewald.Ewald.get_dynamical_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_dynamical_matrix</span></code></a>(atoms)</p></td>
<td><p>Compute dynamical matrix (=mass weighted Hessian).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_elastic_constants" title="matscipy.calculators.ewald.Ewald.get_elastic_constants"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_elastic_constants</span></code></a>(atoms[, cg_parameters])</p></td>
<td><p>Compute the elastic constants at zero temperature.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_forces" title="matscipy.calculators.ewald.Ewald.get_forces"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_forces</span></code></a>([atoms])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_hessian" title="matscipy.calculators.ewald.Ewald.get_hessian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_hessian</span></code></a>(atoms[, format])</p></td>
<td><p>Compute the real space + kspace Hessian</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_magnetic_moment" title="matscipy.calculators.ewald.Ewald.get_magnetic_moment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_magnetic_moment</span></code></a>([atoms])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_magnetic_moments" title="matscipy.calculators.ewald.Ewald.get_magnetic_moments"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_magnetic_moments</span></code></a>([atoms])</p></td>
<td><p>Calculate magnetic moments projected onto atoms.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_non_affine_contribution_to_elastic_constants" title="matscipy.calculators.ewald.Ewald.get_non_affine_contribution_to_elastic_constants"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_non_affine_contribution_to_elastic_constants</span></code></a>(atoms)</p></td>
<td><p><cite>get_non_affine_contribution_to_elastic_constants</cite> is deprecated, use <cite>elasticity.nonaffine_elastic_contribution</cite> instead!</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_nonaffine_forces" title="matscipy.calculators.ewald.Ewald.get_nonaffine_forces"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_nonaffine_forces</span></code></a>(atoms)</p></td>
<td><p>Compute the non-affine forces which result from an affine deformation of atoms.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_numerical_non_affine_forces" title="matscipy.calculators.ewald.Ewald.get_numerical_non_affine_forces"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_numerical_non_affine_forces</span></code></a>(atoms[, d])</p></td>
<td><p><cite>get_numerical_non_affine_forces</cite> is deprecated, use <cite>numerical.numerical_nonaffine_forces</cite> instead!</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_potential_energies" title="matscipy.calculators.ewald.Ewald.get_potential_energies"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_potential_energies</span></code></a>([atoms])</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_potential_energy" title="matscipy.calculators.ewald.Ewald.get_potential_energy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_potential_energy</span></code></a>([atoms, force_consistent])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_property" title="matscipy.calculators.ewald.Ewald.get_property"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_property</span></code></a>(name[, atoms, allow_calculation])</p></td>
<td><p>Get the named property.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_stress" title="matscipy.calculators.ewald.Ewald.get_stress"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_stress</span></code></a>([atoms])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_stress_contribution_to_elastic_constants" title="matscipy.calculators.ewald.Ewald.get_stress_contribution_to_elastic_constants"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_stress_contribution_to_elastic_constants</span></code></a>(atoms)</p></td>
<td><p>Compute the correction to the elastic constants due to non-zero stress in the configuration.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.get_stresses" title="matscipy.calculators.ewald.Ewald.get_stresses"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_stresses</span></code></a>([atoms])</p></td>
<td><p>the calculator should return intensive stresses, i.e., such that stresses.sum(axis=0) == stress</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.kspace_energy" title="matscipy.calculators.ewald.Ewald.kspace_energy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kspace_energy</span></code></a>(charge, pos, vol, I, k)</p></td>
<td><p>Return the energy from the reciprocal space contribution</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.kspace_properties" title="matscipy.calculators.ewald.Ewald.kspace_properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kspace_properties</span></code></a>(atoms[, prop, ...])</p></td>
<td><p>Calculate the recirprocal contributiom to the Hessian, the non-affine forces and the Born elastic constants</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.read" title="matscipy.calculators.ewald.Ewald.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read</span></code></a>(label)</p></td>
<td><p>Read atoms, parameters and calculated properties from output file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.read_atoms" title="matscipy.calculators.ewald.Ewald.read_atoms"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_atoms</span></code></a>(restart, **kwargs)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.reset" title="matscipy.calculators.ewald.Ewald.reset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset</span></code></a>()</p></td>
<td><p>Clear all information from old calculation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.reset_kspace" title="matscipy.calculators.ewald.Ewald.reset_kspace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_kspace</span></code></a>(atoms)</p></td>
<td><p>Reset kspace setup.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.rms_kspace" title="matscipy.calculators.ewald.Ewald.rms_kspace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rms_kspace</span></code></a>(km, l, n, a, q2)</p></td>
<td><p>Compute the root mean square error of the force in reciprocal space</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.rms_rspace" title="matscipy.calculators.ewald.Ewald.rms_rspace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rms_rspace</span></code></a>(charge, cell, a, rc)</p></td>
<td><p>Compute the root mean square error of the force in real space</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.self_energy" title="matscipy.calculators.ewald.Ewald.self_energy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">self_energy</span></code></a>(charge, a)</p></td>
<td><p>Return the self energy</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.set" title="matscipy.calculators.ewald.Ewald.set"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set</span></code></a>(**kwargs)</p></td>
<td><p>Set parameters like set(key1=value1, key2=value2, ...).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.set_label" title="matscipy.calculators.ewald.Ewald.set_label"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_label</span></code></a>(label)</p></td>
<td><p>Set label and convert label to directory and prefix.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.stress_kspace" title="matscipy.calculators.ewald.Ewald.stress_kspace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stress_kspace</span></code></a>(charge, pos, vol, a, I, k)</p></td>
<td><p>Return the stress contribution of the long-range Coulomb part.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.todict" title="matscipy.calculators.ewald.Ewald.todict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">todict</span></code></a>([skip_default])</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.alpha" title="matscipy.calculators.ewald.Ewald.alpha"><code class="xref py py-obj docutils literal notranslate"><span class="pre">alpha</span></code></a></p></td>
<td><p>Get alpha.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.default_parameters" title="matscipy.calculators.ewald.Ewald.default_parameters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_parameters</span></code></a></p></td>
<td><p>Default parameters</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.directory" title="matscipy.calculators.ewald.Ewald.directory"><code class="xref py py-obj docutils literal notranslate"><span class="pre">directory</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.discard_results_on_any_change" title="matscipy.calculators.ewald.Ewald.discard_results_on_any_change"><code class="xref py py-obj docutils literal notranslate"><span class="pre">discard_results_on_any_change</span></code></a></p></td>
<td><p>Whether we purge the results following any change in the set() method.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.ignored_changes" title="matscipy.calculators.ewald.Ewald.ignored_changes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ignored_changes</span></code></a></p></td>
<td><p>Properties of Atoms which we ignore for the purposes of cache</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.implemented_properties" title="matscipy.calculators.ewald.Ewald.implemented_properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">implemented_properties</span></code></a></p></td>
<td><p>Properties calculator can handle (energy, forces, ...)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.label" title="matscipy.calculators.ewald.Ewald.label"><code class="xref py py-obj docutils literal notranslate"><span class="pre">label</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.name" title="matscipy.calculators.ewald.Ewald.name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">name</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#matscipy.calculators.ewald.Ewald.short_range" title="matscipy.calculators.ewald.Ewald.short_range"><code class="xref py py-obj docutils literal notranslate"><span class="pre">short_range</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Ewald'</span></em><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.default_parameters">
<span class="sig-name descname"><span class="pre">default_parameters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'accuracy':</span> <span class="pre">1e-06,</span> <span class="pre">'cutoff':</span> <span class="pre">3,</span> <span class="pre">'kspace':</span> <span class="pre">{},</span> <span class="pre">'verbose':</span> <span class="pre">True}</span></em><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.default_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Default parameters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#id0" title="Permalink to this definition"></a></dt>
<dd><p>Construct calculator.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.short_range">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">short_range</span></span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.short_range" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.alpha">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">alpha</span></span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.alpha" title="Permalink to this definition"></a></dt>
<dd><p>Get alpha.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.set">
<span class="sig-name descname"><span class="pre">set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.set" title="Permalink to this definition"></a></dt>
<dd><p>Set parameters like set(key1=value1, key2=value2, …).</p>
<p>A dictionary containing the parameters that have been changed
is returned.</p>
<p>Subclasses must implement a set() method that will look at the
chaneged parameters and decide if a call to reset() is needed.
If the changed parameters are harmless, like a change in
verbosity, then there is no need to call reset().</p>
<p>The special keyword ‘parameters’ can be used to read
parameters from a file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.reset" title="Permalink to this definition"></a></dt>
<dd><p>Clear all information from old calculation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.determine_alpha">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">determine_alpha</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">charge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.determine_alpha" title="Permalink to this definition"></a></dt>
<dd><p>Determine an estimate for alpha on the basis of the cell, cutoff and desired accuracy
(Adopted from LAMMPS)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.determine_nk">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">determine_nk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">charge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">natoms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.determine_nk" title="Permalink to this definition"></a></dt>
<dd><p>Determine the maximal number of points in reciprocal space for each direction,
and the cutoff in reciprocal space</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.determine_kc">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">determine_kc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nk</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.determine_kc" title="Permalink to this definition"></a></dt>
<dd><p>Determine maximal wave vector based in a given integer triplet</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.rms_kspace">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rms_kspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">km</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.rms_kspace" title="Permalink to this definition"></a></dt>
<dd><p>Compute the root mean square error of the force in reciprocal space</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.rms_rspace">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rms_rspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">charge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.rms_rspace" title="Permalink to this definition"></a></dt>
<dd><p>Compute the root mean square error of the force in real space</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.allowed_wave_vectors">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">allowed_wave_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">km</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nk</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.allowed_wave_vectors" title="Permalink to this definition"></a></dt>
<dd><p>Compute allowed wave vectors and the prefactor I</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.self_energy">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">self_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">charge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.self_energy" title="Permalink to this definition"></a></dt>
<dd><p>Return the self energy</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.kspace_energy">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kspace_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">charge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.kspace_energy" title="Permalink to this definition"></a></dt>
<dd><p>Return the energy from the reciprocal space contribution</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.first_derivative_kspace">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">first_derivative_kspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">charge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">natoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.first_derivative_kspace" title="Permalink to this definition"></a></dt>
<dd><p>Return the kspace part of the force.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.stress_kspace">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stress_kspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">charge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.stress_kspace" title="Permalink to this definition"></a></dt>
<dd><p>Return the stress contribution of the long-range Coulomb part.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.reset_kspace">
<span class="sig-name descname"><span class="pre">reset_kspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.reset_kspace" title="Permalink to this definition"></a></dt>
<dd><p>Reset kspace setup.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_changes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.calculate" title="Permalink to this definition"></a></dt>
<dd><p>Compute Coulomb interactions with Ewald summation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.kspace_properties">
<span class="sig-name descname"><span class="pre">kspace_properties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Hessian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divide_by_masses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.kspace_properties" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the recirprocal contributiom to the Hessian, the non-affine
forces and the Born elastic constants</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>ase.Atoms</em>) – Atomic configuration in a local or global minima.</p></li>
<li><p><strong>prop</strong> (<em>&quot;Hessian&quot;</em><em>, </em><em>&quot;Born&quot;</em><em> or </em><em>&quot;Naforces&quot;</em>) – Compute either the Hessian/Dynamical matrix, the Born constants
or the non-affine forces.</p></li>
<li><p><strong>divide_by_masses</strong> (<em>bool</em>) – if true return the dynamic matrix else Hessian matrix</p></li>
<li><p><strong>Restrictions</strong> – </p></li>
<li><p><strong>----------</strong> – </p></li>
<li><p><strong>systems</strong> (<em>This method is currently only implemented for three dimensional</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.get_hessian">
<span class="sig-name descname"><span class="pre">get_hessian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.get_hessian" title="Permalink to this definition"></a></dt>
<dd><p>Compute the real space + kspace Hessian</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.get_nonaffine_forces">
<span class="sig-name descname"><span class="pre">get_nonaffine_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.get_nonaffine_forces" title="Permalink to this definition"></a></dt>
<dd><p>Compute the non-affine forces which result from an affine deformation of atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>atoms</strong> (<em>ase.Atoms</em>) – Atomic configuration in a local or global minima.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.band_structure">
<span class="sig-name descname"><span class="pre">band_structure</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.band_structure" title="Permalink to this definition"></a></dt>
<dd><p>Create band-structure object for plotting.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.calculate_numerical_forces">
<span class="sig-name descname"><span class="pre">calculate_numerical_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.calculate_numerical_forces" title="Permalink to this definition"></a></dt>
<dd><p>Calculate numerical forces using finite difference.</p>
<p>All atoms will be displaced by +d and -d in all directions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.calculate_numerical_stress">
<span class="sig-name descname"><span class="pre">calculate_numerical_stress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voigt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.calculate_numerical_stress" title="Permalink to this definition"></a></dt>
<dd><p>Calculate numerical stress using finite difference.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.calculate_properties">
<span class="sig-name descname"><span class="pre">calculate_properties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.calculate_properties" title="Permalink to this definition"></a></dt>
<dd><p>This method is experimental; currently for internal use.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.calculation_required">
<span class="sig-name descname"><span class="pre">calculation_required</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.calculation_required" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.check_state">
<span class="sig-name descname"><span class="pre">check_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-15</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.check_state" title="Permalink to this definition"></a></dt>
<dd><p>Check for any system changes since last calculation.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.directory">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">directory</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.directory" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.discard_results_on_any_change">
<span class="sig-name descname"><span class="pre">discard_results_on_any_change</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.discard_results_on_any_change" title="Permalink to this definition"></a></dt>
<dd><p>Whether we purge the results following any change in the set() method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.export_properties">
<span class="sig-name descname"><span class="pre">export_properties</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.export_properties" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.get_atoms">
<span class="sig-name descname"><span class="pre">get_atoms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.get_atoms" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.get_birch_coefficients">
<span class="sig-name descname"><span class="pre">get_birch_coefficients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.get_birch_coefficients" title="Permalink to this definition"></a></dt>
<dd><p>Compute the Birch coefficients (Effective elastic constants at non-zero stress).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>atoms</strong> (<em>ase.Atoms</em>) – Atomic configuration in a local or global minima.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.get_born_elastic_constants">
<span class="sig-name descname"><span class="pre">get_born_elastic_constants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.get_born_elastic_constants" title="Permalink to this definition"></a></dt>
<dd><p>Compute the Born elastic constants.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>atoms</strong> (<em>ase.Atoms</em>) – Atomic configuration in a local or global minima.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.get_charges">
<span class="sig-name descname"><span class="pre">get_charges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.get_charges" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.get_default_parameters">
<span class="sig-name descname"><span class="pre">get_default_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.get_default_parameters" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.get_dipole_moment">
<span class="sig-name descname"><span class="pre">get_dipole_moment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.get_dipole_moment" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.get_dynamical_matrix">
<span class="sig-name descname"><span class="pre">get_dynamical_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.get_dynamical_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Compute dynamical matrix (=mass weighted Hessian).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.get_elastic_constants">
<span class="sig-name descname"><span class="pre">get_elastic_constants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cg_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'M':</span> <span class="pre">None,</span> <span class="pre">'atol':</span> <span class="pre">1e-05,</span> <span class="pre">'callback':</span> <span class="pre">None,</span> <span class="pre">'maxiter':</span> <span class="pre">None,</span> <span class="pre">'tol':</span> <span class="pre">1e-05,</span> <span class="pre">'x0':</span> <span class="pre">None}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.get_elastic_constants" title="Permalink to this definition"></a></dt>
<dd><p>Compute the elastic constants at zero temperature.
These are sum of the born, the non-affine and the stress contribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>ase.Atoms</em>) – Atomic configuration in a local or global minima.</p></li>
<li><p><strong>cg_parameters</strong> (<em>dict</em>) – <p>Dictonary for the conjugate-gradient solver.</p>
<dl class="simple">
<dt>x0: {array, matrix}</dt><dd><p>Starting guess for the solution.</p>
</dd>
<dt>tol/atol: float, optional</dt><dd><p>Tolerances for convergence, norm(residual) &lt;= max(tol*norm(b), atol).</p>
</dd>
<dt>maxiter: int</dt><dd><p>Maximum number of iterations. Iteration will stop after maxiter steps even if the specified tolerance has not been achieved.</p>
</dd>
<dt>M: {sparse matrix, dense matrix, LinearOperator}</dt><dd><p>Preconditioner for A.</p>
</dd>
<dt>callback: function</dt><dd><p>User-supplied function to call after each iteration.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.get_forces">
<span class="sig-name descname"><span class="pre">get_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.get_forces" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.get_magnetic_moment">
<span class="sig-name descname"><span class="pre">get_magnetic_moment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.get_magnetic_moment" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.get_magnetic_moments">
<span class="sig-name descname"><span class="pre">get_magnetic_moments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.get_magnetic_moments" title="Permalink to this definition"></a></dt>
<dd><p>Calculate magnetic moments projected onto atoms.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.get_non_affine_contribution_to_elastic_constants">
<span class="sig-name descname"><span class="pre">get_non_affine_contribution_to_elastic_constants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenvalues</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenvectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pc_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cg_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'M':</span> <span class="pre">None,</span> <span class="pre">'atol':</span> <span class="pre">1e-05,</span> <span class="pre">'callback':</span> <span class="pre">None,</span> <span class="pre">'maxiter':</span> <span class="pre">None,</span> <span class="pre">'tol':</span> <span class="pre">1e-05,</span> <span class="pre">'x0':</span> <span class="pre">None}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.get_non_affine_contribution_to_elastic_constants" title="Permalink to this definition"></a></dt>
<dd><p><cite>get_non_affine_contribution_to_elastic_constants</cite> is deprecated, use <cite>elasticity.nonaffine_elastic_contribution</cite> instead!</p>
<p>Compute the correction of non-affine displacements to the elasticity tensor.
The computation of the occuring inverse of the Hessian matrix is bypassed by using a cg solver.</p>
<p>If eigenvalues and and eigenvectors are given the inverse of the Hessian can be easily computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>ase.Atoms</em>) – Atomic configuration in a local or global minima.</p></li>
<li><p><strong>eigenvalues</strong> (<em>array</em>) – Eigenvalues in ascending order obtained by diagonalization of Hessian matrix.
If given, use eigenvalues and eigenvectors to compute non-affine contribution.</p></li>
<li><p><strong>eigenvectors</strong> (<em>array</em>) – Eigenvectors corresponding to eigenvalues.</p></li>
<li><p><strong>cg_parameters</strong> (<em>dict</em>) – <p>Dictonary for the conjugate-gradient solver.</p>
<dl class="simple">
<dt>x0: {array, matrix}</dt><dd><p>Starting guess for the solution.</p>
</dd>
<dt>tol/atol: float, optional</dt><dd><p>Tolerances for convergence, norm(residual) &lt;= max(tol*norm(b), atol).</p>
</dd>
<dt>maxiter: int</dt><dd><p>Maximum number of iterations. Iteration will stop after maxiter steps even if the specified tolerance has not been achieved.</p>
</dd>
<dt>M: {sparse matrix, dense matrix, LinearOperator}</dt><dd><p>Preconditioner for A.</p>
</dd>
<dt>callback: function</dt><dd><p>User-supplied function to call after each iteration.</p>
</dd>
</dl>
</p></li>
<li><p><strong>pc_parameters</strong> (<em>dict</em>) – <p>Dictonary for the incomplete LU decomposition of the Hessian.</p>
<dl class="simple">
<dt>A: array_like</dt><dd><p>Sparse matrix to factorize.</p>
</dd>
<dt>drop_tol: float</dt><dd><p>Drop tolerance for an incomplete LU decomposition.</p>
</dd>
<dt>fill_factor: float</dt><dd><p>Specifies the fill ratio upper bound.</p>
</dd>
<dt>drop_rule: str</dt><dd><p>Comma-separated string of drop rules to use.</p>
</dd>
<dt>permc_spec: str</dt><dd><p>How to permute the columns of the matrix for sparsity.</p>
</dd>
<dt>diag_pivot_thresh: float</dt><dd><p>Threshold used for a diagonal entry to be an acceptable pivot.</p>
</dd>
<dt>relax: int</dt><dd><p>Expert option for customizing the degree of relaxing supernodes.</p>
</dd>
<dt>panel_size: int</dt><dd><p>Expert option for customizing the panel size.</p>
</dd>
<dt>options: dict</dt><dd><p>Dictionary containing additional expert options to SuperLU.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.get_numerical_non_affine_forces">
<span class="sig-name descname"><span class="pre">get_numerical_non_affine_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.get_numerical_non_affine_forces" title="Permalink to this definition"></a></dt>
<dd><p><cite>get_numerical_non_affine_forces</cite> is deprecated, use <cite>numerical.numerical_nonaffine_forces</cite> instead!</p>
<p>Calculate numerical non-affine forces using central finite differences.
This is done by deforming the box, rescaling atoms and measure the force.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>atoms</strong> (<em>ase.Atoms</em>) – Atomic configuration in a local or global minima.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.get_potential_energies">
<span class="sig-name descname"><span class="pre">get_potential_energies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.get_potential_energies" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.get_potential_energy">
<span class="sig-name descname"><span class="pre">get_potential_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_consistent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.get_potential_energy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.get_property">
<span class="sig-name descname"><span class="pre">get_property</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_calculation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.get_property" title="Permalink to this definition"></a></dt>
<dd><p>Get the named property.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.get_stress">
<span class="sig-name descname"><span class="pre">get_stress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.get_stress" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.get_stress_contribution_to_elastic_constants">
<span class="sig-name descname"><span class="pre">get_stress_contribution_to_elastic_constants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.get_stress_contribution_to_elastic_constants" title="Permalink to this definition"></a></dt>
<dd><p>Compute the correction to the elastic constants due to non-zero stress in the configuration.
Stress term  results from working with the Cauchy stress.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>atoms</strong> (<em>ase.Atoms</em>) – Atomic configuration in a local or global minima.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.get_stresses">
<span class="sig-name descname"><span class="pre">get_stresses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.get_stresses" title="Permalink to this definition"></a></dt>
<dd><p>the calculator should return intensive stresses, i.e., such that
stresses.sum(axis=0) == stress</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.ignored_changes">
<span class="sig-name descname"><span class="pre">ignored_changes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.ignored_changes" title="Permalink to this definition"></a></dt>
<dd><p>Properties of Atoms which we ignore for the purposes of cache</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.implemented_properties">
<span class="sig-name descname"><span class="pre">implemented_properties</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['energy',</span> <span class="pre">'free_energy',</span> <span class="pre">'stress',</span> <span class="pre">'forces',</span> <span class="pre">'hessian',</span> <span class="pre">'dynamical_matrix',</span> <span class="pre">'nonaffine_forces',</span> <span class="pre">'birch_coefficients',</span> <span class="pre">'nonaffine_elastic_contribution',</span> <span class="pre">'stress_elastic_contribution',</span> <span class="pre">'born_constants',</span> <span class="pre">'elastic_constants']</span></em><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.implemented_properties" title="Permalink to this definition"></a></dt>
<dd><p>Properties calculator can handle (energy, forces, …)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.label">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.label" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.read">
<span class="sig-name descname"><span class="pre">read</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.read" title="Permalink to this definition"></a></dt>
<dd><p>Read atoms, parameters and calculated properties from output file.</p>
<p>Read result from self.label file.  Raise ReadError if the file
is not there.  If the file is corrupted or contains an error
message from the calculation, a ReadError should also be
raised.  In case of succes, these attributes must set:</p>
<dl class="simple">
<dt>atoms: Atoms object</dt><dd><p>The state of the atoms from last calculation.</p>
</dd>
<dt>parameters: Parameters object</dt><dd><p>The parameter dictionary.</p>
</dd>
<dt>results: dict</dt><dd><p>Calculated properties like energy and forces.</p>
</dd>
</dl>
<p>The FileIOCalculator.read() method will typically read atoms
and parameters and get the results dict by calling the
read_results() method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.read_atoms">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">restart</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.read_atoms" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.set_label">
<span class="sig-name descname"><span class="pre">set_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.set_label" title="Permalink to this definition"></a></dt>
<dd><p>Set label and convert label to directory and prefix.</p>
<p>Examples:</p>
<ul class="simple">
<li><p>label=’abc’: (directory=’.’, prefix=’abc’)</p></li>
<li><p>label=’dir1/abc’: (directory=’dir1’, prefix=’abc’)</p></li>
<li><p>label=None: (directory=’.’, prefix=None)</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matscipy.calculators.ewald.Ewald.todict">
<span class="sig-name descname"><span class="pre">todict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skip_default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.ewald.Ewald.todict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="matscipy.calculators.eam.EAM.html" class="btn btn-neutral float-left" title="matscipy.calculators.eam.EAM" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="matscipy.calculators.manybody.Manybody.html" class="btn btn-neutral float-right" title="matscipy.calculators.manybody.Manybody" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015, James Kermode, Lars Pastewka.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>